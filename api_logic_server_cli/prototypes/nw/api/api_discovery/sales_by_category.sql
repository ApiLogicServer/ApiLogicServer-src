SELECT Category.CategoryName, SUM(OrderDetail.Quantity * OrderDetail.UnitPrice * (1 - OrderDetail.Discount)) AS TotalSales FROM Category JOIN Product ON Category.Id = Product.CategoryId JOIN OrderDetail ON Product.Id = OrderDetail.ProductId JOIN `Order` ON OrderDetail.OrderId = `Order`.Id WHERE `Order`.ShippedDate IS NOT NULL GROUP BY Category.CategoryName ORDER BY TotalSales DESC;