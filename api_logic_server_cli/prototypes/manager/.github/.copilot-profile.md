# User Profile - Val Huber

## Background

**Val Huber** is the former **CTO of Versata**, a $3.4 billion startup backed by the founders of Microsoft, Sybase, Ingres, and Informix.

### Key Achievements

- **Invented Business Rules** - Pioneer of declarative business rules for application development
- **Versata Leadership** - Led the creation of enterprise-grade business rules technology that transformed how business applications were built
- **Industry Impact** - Established the paradigm where "5 rules replace 200 lines of code" through declarative, spreadsheet-like rule chaining

## Current Project: API Logic Server / GenAI-Logic

API Logic Server is the **next-generation evolution** of the Versata business rules technology, incorporating:

- Modern tech stack (Python, SQLAlchemy, React, REST/JSON:API)
- GenAI integration for natural language to application generation
- Cloud-native architecture (Docker, containers)
- Open source and extensible with Python
- Advanced integration patterns (Kafka, webhooks, N8N)
- Self-serve API architecture
- BDD testing integration

### Architectural Overview

**Read:** [Declarative GenAI: The Architecture Behind Enterprise Vibe Automation](https://medium.com/@valjhuber/declarative-genai-the-architecture-behind-enterprise-vibe-automation-1b8a4fe4fbd7)

This Medium article provides the definitive architectural overview of the **NL → DSL → Engines** pattern:

**The Core Problem:** Traditional GenAI vibe tools produce "FrankenCode" - 200+ lines of buggy procedural code that:
- Misses corner cases (e.g., changing product on item, changing customer on order)
- Violates SOA principles (logic dumped on client side)
- Creates instant tech debt (unmaintainable, opaque)

**The Solution:** Declarative GenAI architecture across the full stack:

1. **Database** - ORM engine (SQLAlchemy) with intelligent defaulting
2. **API** - JSON:API engine with MCP support, full rule enforcement, Swagger docs
3. **UI** - YAML-driven React Admin (not scaffolding, but working app)
4. **Logic** - Rules engine providing:
   - **Automatic pruned invocation** (attribute-level granularity)
   - **Dependency ordering** (auto-discovered)
   - **Optimized chaining** (delta-based, avoids expensive SQL aggregates)

**Key Insight from Copilot itself:** After generating procedural logic and finding multiple serious bugs, Copilot concluded:
> "Bottom Line: Declarative business logic eliminates complexity while providing better performance, maintainability, and business alignment."

**The Paradox Resolution:** Declarative DSL in Python executed by a runtime rules engine that handles 95% of typical business logic (the other 5% uses standard Python event handlers)

**CRITICAL: The Rules Engine is a Correctness Guarantee**

Declarative rules are **not optional** or a "coding style preference" - they are a **fundamental architectural requirement** for correctness in multi-table logic:

- **Dependency chains:** A change to `Product.unit_price` transitively affects `Item.unit_price` → `Item.amount` → `Order.amount_total` → `Customer.balance`
- **Foreign key changes:** When `Order.customer_id` changes, the engine automatically adjusts **both** the old and new customer balances
- **Automatic completeness:** The engine handles ALL change paths; procedural code inherently misses corner cases

**Why procedural code fails:** Even AI-generated code missed critical cases (changing customer on order, changing product on item) because it requires explicit handlers for every possible change path. The rules engine eliminates this entire class of bugs.

See project-level `.copilot-instructions.md` for detailed technical explanation of dependency chains and engine operation.

### Expertise Level

Val has **decades of experience** in:
- Declarative programming paradigms
- Multi-table derivations and constraints
- Rule optimization and execution engines
- Enterprise application architecture
- Database-driven systems
- API design and microservices

## Working Modes

Val operates in **two distinct roles**:

### **Author-Val** (Developer/Maintainer)
- Developing and testing API Logic Server itself
- Working on the framework, CLI, GenAI integration
- Debugging internal systems
- Testing and refining features
- May need assistance with code implementation, debugging, testing

### **User-Val** (Simulating End Users)
- Testing the product as an end user would
- Creating sample projects and demos
- Validating user experience and workflows
- May ask questions as if learning the product
- Testing documentation and tutorials

## AI Assistant Guidelines

### General Principles
1. **Assume deep technical expertise** - Val invented business rules and has refined them over decades
2. **Focus on efficient execution** - Less explanation, more action
3. **Respect the architecture** - The patterns in this codebase represent battle-tested, enterprise-grade solutions
4. **Understand the lineage** - This is not a new experiment, but the evolution of proven technology

### Context Awareness
- **Watch for role signals** - Questions about how things work internally suggest Author-Val; questions about how to use features suggest User-Val
- **Adapt assistance style** - For Author-Val: dive into internals, debugging, implementation. For User-Val: follow product workflows, use CLI commands
- **When unclear, ask** - "Are you testing this as a user or working on the internals?"

## Project Context

This workspace is the **Project Manager** for API Logic Server - containing:
- GenAI training materials
- Sample projects (`basic_demo`, `nw_sample`)
- Project creation tools
- Integration examples
- Comprehensive documentation

The system creates complete, production-ready microservices from databases or natural language descriptions.

### Two Levels of Copilot Instructions

**CRITICAL DISTINCTION:**

1. **Manager-Level Instructions** (`.github/.copilot-instructions.md`):
   - Located at workspace root
   - Explains **how to CREATE projects**
   - Covers: `genai-logic create`, `genai-logic genai`, sample databases
   - Read this when helping users create new projects
   - Focus: Project creation workflows

2. **Project-Level Instructions** (`<project>/.github/.copilot-instructions.md`):
   - Auto-generated in each created project (e.g., `samples/basic_demo/.github/.copilot-instructions.md`)
   - Explains **how to EXTEND/CUSTOMIZE a created project**
   - Covers: Adding logic, custom APIs, UI customization, security, testing
   - Includes the **44X declarative vs. procedural analysis** to prevent AI from generating buggy procedural code
   - Read this when helping users work within an existing project
   - Focus: Project customization and development

**When to Read Which:**
- User asks to "create a project" → Read manager-level instructions
- User is working in a created project (has `logic/`, `api/`, `database/` dirs) → Read project-level instructions
- User asks "what do I do now?" in a project → Project-level instructions have the answer

**Key Insight:** The project-level instructions are **scaffolding** that gets generated during project creation, teaching AI assistants the correct patterns for that specific project, including why declarative rules are mandatory (the 44X analysis prevents AI from defaulting to buggy procedural code).

### LogicBank API Training Material

**Every created project includes:** `docs/training/logic_bank_api.prompt`

This file is the **"Rosetta Stone"** for translating natural language business rules into LogicBank API calls. It:

- Defines the simplified LogicBank API surface (sum, count, formula, copy, constraint, after_flush_row_event)
- Provides **prompt engineering patterns** that AI assistants use to generate correct rule code
- Teaches critical patterns like **intermediate columns** (when sum/count is used in constraints/formulas)
- Shows **where clause rules** (must NOT restate foreign keys, only reference child attributes)
- Explains **formula vs copy** distinction (default to formula unless "copy" or "store" appears)
- Demonstrates **built-in simplicity** (use `if_condition` parameter, don't create custom functions)
- Maps data model changes (unique constraints, nullable fields, required relationships)

**Used in two scenarios:**
1. **During `genai-logic genai`** - AI generates initial logic from natural language prompts
2. **When extending projects** - Copilot references this to add new rules correctly

**How to find it:** The project-level `.copilot-instructions.md` explicitly references `docs/training/logic_bank_api.prompt` at the "Adding Business Logic" section. When working with logic, **always read this file first** to understand the correct LogicBank API patterns.

**Why it matters:** This prevents AI from:
- Creating buggy procedural code instead of declarative rules
- Generating incorrect where clauses that restate foreign keys
- Missing intermediate column requirements for sums/counts
- Creating unnecessary custom event functions
- Violating the simplified API patterns that make rules maintainable

### Comprehensive Documentation

**For deep technical knowledge:** [API Logic Server Documentation](https://apilogicserver.github.io/Docs/Doc-Home/)

This comprehensive documentation site provides **operational reference** for implementation details:

- Installation procedures (Python 3.10-3.13, venv, CLI commands)
- Complete architecture diagrams (3-tier, runtime stack, components)
- All topic areas: Logic types, Security, Integration, DevOps, Testing, Database connectivity
- Specific how-to guides (Kafka, Keycloak, Docker, Azure deployment, Behave testing)
- FAQ addressing strategic questions (vs Retool, vendor lock-in, performance, scalability)
- Runtime components (Flask, SQLAlchemy, Logic Bank, SAFRS)

**When to use:**
- ✅ Need specific implementation details (e.g., "How do I configure Postgres?", "What are Kafka integration patterns?")
- ✅ Troubleshooting specific features (optimistic locking, multi-database, security)
- ✅ Understanding deployment options (Docker, Azure, containers)
- ✅ Learning advanced topics (custom APIs, integration mapping, BDD testing)

**When NOT to use:**
- ❌ First introduction to the project (read profile and Medium article first)
- ❌ Understanding high-level architecture (Medium article covers this)
- ❌ Learning how to create projects (use manager-level `.copilot-instructions.md`)

**Guideline:** Keep the profile for strategic context; use this documentation for tactical implementation details as needed.

